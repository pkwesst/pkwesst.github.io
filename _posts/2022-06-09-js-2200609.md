---
layout: single
title: "[JS] 브라우저 렌더링 "
categories: JavaScript
tag: [JavaScript]

toc: true
toc_sticky: true
published: true
future: true

date: 2022-06-09
last_modified_at: 2022-06-11

---

## #1. 브라우저 렌더링 과정
**: DNS -> HTTP/HTTPS 통신 -> DOM 트리 생성 -> JS엔진이 JS 파싱 -> DOM 트리 완성 -> RENDER 트리 -> Paint**

1. 브라우저 창에 주소 입력하면 `DNS`가 해당 주소의 서버를 찾음
2. `HTTP/HTTPS` 방식으로 통신
3. HTML, CSS 리소스 파일을 브라우저에 보냄
4. `웹 브라우저 엔진`이 텍스트 형태의 `리소스 파일 파싱` ⇒ 한 줄씩 읽으며 `DOM 트리 생성`
- 중간에 link 태그 만나 CSS 요청 발생 시, CSS 파싱하며 CSSOM 트리 생성
- 중간에 script 태그 만나 JS 요청 발생 시, 제어 권한을 웹 브라우저가 JS엔진에게 넘기고 JS코드/파일을 로드해 파싱
1. CSS/JS 파싱 완료되면 중단된 HTML 다시 읽어 `DOM 트리 완성`
2. DOM 트리와 CSSOM 트리로 `RENDER 트리` 구축
3. 뷰포트에 맞춰 RENDER 트리 배치
4. 픽셀을 화면에 Paint  

## #2. 브라우저 렌더링 과정에서 JS 동작 방법  

1. HTML/CSS 파싱 과정과 마찬가지로 `웹 브라우저 엔진`은 HTML을 한 줄씩 순차적으로 파싱하며 DOM을 생성하다가 JS 파일을 로드하는 `<sciprt>` 태그나 JS 코드를 콘텐츠로 담은 `<script>` 태그를 만나면 `DOM 생성을 일시 중단`  
  
2. <sciprt> 태그의 src 어트리뷰트에 정의된 자바스크립트 파일을 서버에 요청하여 로드한 JS 파일이나 <script> 태그 내의 JS 코드를 `파싱`하기 위해 `JS 엔진`에 제어권을 넘김. 이후 JS 파싱과 실행이 종료되면 `웹 브라우저 엔진`으로 다시 제어권을 넘겨 html 파싱이 중단된 지점부터 다시 html 파싱을 시작하여 `DOM 생성을 재개`  
  
3. `JS 파싱`과 `실행`은 브라우저 렌더링 엔진이 아닌 `JS 엔진`이 처리함. JS 엔진은 JS 코드를 파싱하여 CPU가 이해할 수 있는 저수준 언어로 변환하고 실행하는 역할을 함  
  
4. `JS 엔진`은 JS를 해석하여 `AST(Abstract Syntax Tree: 추상적 구문 트리)`를 생성함. 그리고 AST를 기반으로 인터프리터가 실행할 수 있는 중간 코드인 바이트코드를 생성하여 실행함  
  
5. `리플로우와 리페인트`  
    - JS 코드에 DOM이나 CSSOM(CSS Object Model)을 변경하는 `DOM API`가 사용된 경우 DOM이나 CSSOM이 변경됨  
    - 이때 변경된 DOM과 CSSOM은 다시 렌더 트리로 결합되고 `변경된 렌더 트리`를 기반으로 레이아웃과 페인트 과정을 거쳐 브라우저의 화면에 `다시 렌더링`됨. 이를 리플로우, 리페인트라고 함  
  
## #3. 용어 정리  
  
### ✅ 컴파일러  

- 소스 코드를 기계어로 전체를 번역해 실행 파일 생성  

### ✅ 컴파일  

- parsing tree를 기계 코드로 변환  

### ✅ 인터프리터  

- 소스 코드를 기계어로 한 줄씩 해석해서 바로 명령어를 실행  

### ✅ 파싱  

- 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것  
  
1. 어휘 분석 ⇒ `어휘 분석기`  
    - 자료를 토큰으로 변경(공백, 줄바꿈 제거 등)  
  
2. 구문 분석 ⇒ `파서`  
    - 언어 구문 규칙에 따라 문서 구조를 분석해 parsing tree 생성  

### ✅ 파서  

- HTML 마크업 ⇒ DOM으로 변환  
- CSS 마크업 ⇒ CSSOM으로 변환  

### ✅ DOM TREE  

- HTML 파일 파싱  
- parsing tree로 구성되어 있음  

### ✅ CSSOM TREE  

- CSS 파일 파싱, 스타일 규칙  

### ✅ RENDER TREE  

- DOM TREE + CSSOM TREE  
  
